description: "Setup bun with caching"
steps:
  - restore_cache:
      name: Restore bun cache
      keys:
        - bun-packages-{{ checksum "bun.lock" }}
  - run:
      name: Install bun
      command: |
        curl -fsSL https://bun.sh/install | bash
        echo 'export BUN_INSTALL="$HOME/.bun"' >> $BASH_ENV
        echo 'export PATH="$BUN_INSTALL/bin:$PATH"' >> $BASH_ENV
  - run:
      name: Install dependencies
      command: bun install --frozen-lockfile
  - save_cache:
      name: Save bun cache
      key: bun-packages-{{ checksum "bun.lock" }}
      paths:
        - ~/.bun/install/cache
        - node_modules
